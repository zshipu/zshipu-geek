<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>以太坊从零到略懂5：Truffle 快速入门体验智能合约 | 知识铺的博客</title>
    <meta property="og:title" content="以太坊从零到略懂5：Truffle 快速入门体验智能合约 - 知识铺的博客">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2022-06-11T05:05:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2022-06-11T05:05:00&#43;08:00'>
        
    <meta name="Keywords" content="golang,go语言,go语言笔记,知识铺,java,android,博客,项目管理,python,软件架构,公众号,小程序">
    <meta name="description" content="以太坊从零到略懂5：Truffle 快速入门体验智能合约">
        <meta name="author" content="知识铺">
        
    <meta property="og:url" content="https://geek.zshipu.com/post/web3.0/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%8E%E9%9B%B6%E5%88%B0%E7%95%A5%E6%87%825Truffle-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E4%BD%93%E9%AA%8C%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6/">
    <link rel="shortcut icon" href='/favicon.ico'  type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    <script data-ad-client="ca-pub-2874221941555456" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    
    
    
    
    
    
    
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-WLWJSST');</script>
    
</head>


<body>

<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WLWJSST"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://geek.zshipu.com/">
                        知识铺的博客
                    </a>
                
                <p class="description">专注于Android、Java、Go语言(golang)、移动互联网、项目管理、软件架构</p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="current" href="https://geek.zshipu.com/">首页</a>
                    
                    <a  href="https://geek.zshipu.com/archives/" title="归档">归档</a>
                    
                    <a  href="https://geek.zshipu.com/about/" title="关于">关于</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    <style type="text/css">
    .post-toc {
        position: fixed;
        width: 200px;
        margin-left: -210px;
        padding: 5px 10px;
        font-family: Athelas, STHeiti, Microsoft Yahei, serif;
        font-size: 12px;
        border: 1px solid rgba(0, 0, 0, .07);
        border-radius: 5px;
        background-color: rgba(255, 255, 255, 0.98);
        background-clip: padding-box;
        -webkit-box-shadow: 1px 1px 2px rgba(0, 0, 0, .125);
        box-shadow: 1px 1px 2px rgba(0, 0, 0, .125);
        word-wrap: break-word;
        white-space: nowrap;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        z-index: 999;
        cursor: pointer;
        max-height: 70%;
        overflow-y: auto;
        overflow-x: hidden;
    }

    .post-toc .post-toc-title {
        width: 100%;
        margin: 0 auto;
        font-size: 20px;
        font-weight: 400;
        text-transform: uppercase;
        text-align: center;
    }

    .post-toc .post-toc-content {
        font-size: 15px;
    }

    .post-toc .post-toc-content>nav>ul {
        margin: 10px 0;
    }

    .post-toc .post-toc-content ul {
        padding-left: 20px;
        list-style: square;
        margin: 0.5em;
        line-height: 1.8em;
    }

    .post-toc .post-toc-content ul ul {
        padding-left: 15px;
        display: none;
    }

    @media print,
    screen and (max-width:1057px) {
        .post-toc {
            display: none;
        }
    }
</style>
<div class="post-toc" style="position: absolute; top: 188px;">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#安装truffle">安装Truffle</a></li>
    <li><a href="#创建项目">创建项目</a></li>
    <li><a href="#探索项目">探索项目</a></li>
    <li><a href="#测试">测试</a></li>
    <li><a href="#编译">编译</a></li>
    <li><a href="#使用-truffle-develop-迁移">使用 Truffle Develop 迁移</a></li>
    <li><a href="#替代方案使用-ganache-迁移">替代方案：使用 Ganache 迁移</a></li>
    <li><a href="#与合约互动">与合约互动</a></li>
  </ul>
</nav>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        var postToc = $(".post-toc");
        if (postToc.length) {
            var leftPos = $("#main").offset().left;
            if(leftPos<220){
                postToc.css({"width":leftPos-10,"margin-left":(0-leftPos)})
            }

            var t = postToc.offset().top - 20,
                a = {
                    start: {
                        position: "absolute",
                        top: t
                    },
                    process: {
                        position: "fixed",
                        top: 20
                    },
                };
            $(window).scroll(function () {
                var e = $(window).scrollTop();
                e < t ? postToc.css(a.start) : postToc.css(a.process)
            })
        }
    })
</script>
    <article class="post">
        <header>
            <h1 class="post-title">以太坊从零到略懂5：Truffle 快速入门体验智能合约</h1>
        </header>
        <date class="post-meta meta-date">
            2022年6月11日
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            <h2 id="安装truffle">安装Truffle</h2>
<p>在你可以使用 Truffle 之前，你必须使用 npm 安装它。打开终端并使用以下命令进行全局安装。</p>
<pre tabindex="0"><code>npm install -g truffle
</code></pre><p><strong>注意</strong>：我们建议您将 npm 与 nvm 之类的节点版本管理器一起使用，这实际上是 npm 本身所推荐的。请参阅npm 的<a href="https://docs.npmjs.com/downloading-and-installing-node-js-and-npm">这篇文章</a>，了解如何使用节点版本管理器安装 npm。我们还建议不要<code>sudo</code>在安装 Truffle 时使用，因为许多用户在这样做后会报告权限错误。</p>
<h2 id="创建项目">创建项目</h2>
<p>要使用大多数 Truffle 命令，您需要针对现有的 Truffle 项目运行它们。所以第一步是创建一个 Truffle 项目。</p>
<p>您可以创建一个裸项目模板，但对于那些刚刚开始的人，您可以使用<a href="https://trufflesuite.com/boxes">Truffle Boxes</a>，它们是示例应用程序和项目模板。我们将使用<a href="https://trufflesuite.com/boxes/metacoin">MetaCoin box</a>，它创建一个可以在账户之间转移的代币：</p>
<ol>
<li>为您的 Truffle 项目创建一个新目录：</li>
</ol>
<pre tabindex="0"><code>mkdir MetaCoin
cd MetaCoin
</code></pre><ol>
<li>下载（“拆箱”）MetaCoin 盒子：</li>
</ol>
<pre tabindex="0"><code>truffle unbox metacoin
</code></pre><p><strong>注意</strong>：您可以使用该<code>truffle unbox &lt;box-name&gt;</code>命令下载任何其他Truffle盒。</p>
<p><strong>注意</strong>：要创建不包含智能合约的裸 Truffle 项目，请使用<code>truffle init</code>.</p>
<p>完成此操作后，您现在将拥有一个包含以下项目的项目结构：</p>
<ul>
<li><code>contracts/</code>: <a href="https://trufflesuite.com/docs/truffle/getting-started/interacting-with-your-contracts">Solidity 合约目录</a></li>
<li><code>migrations/</code>:<a href="https://trufflesuite.com/docs/truffle/getting-started/running-migrations#migration-files">可编写脚本的部署文件的目录</a></li>
<li><code>test/</code>: 用于<a href="https://trufflesuite.com/docs/truffle/testing/testing-your-contracts">测试应用程序和合约的测试文件目录</a></li>
<li><code>truffle.js</code>: Truffle<a href="https://trufflesuite.com/docs/truffle/reference/configuration">配置文件</a></li>
</ul>
<h2 id="探索项目">探索项目</h2>
<p><strong>注意</strong>：此页面只是一个快速入门，因此我们不会在这里详细介绍。请参阅 Truffle 文档的其余部分以了解更多信息。</p>
<ol>
<li><code>contracts/MetaCoin.sol</code>在文本编辑器中打开文件。这是一个创建 MetaCoin 代币的智能合约（用 Solidity 编写）。请注意，这也引用<code>contracts/ConvertLib.sol</code>了同一目录中的另一个 Solidity 文件。</li>
<li>打开<code>contracts/Migrations.sol</code>文件。这是一个单独的 Solidity 文件，用于管理和更新<a href="https://trufflesuite.com/docs/truffle/getting-started/running-migrations">您部署的智能合约的状态</a>。该文件随每个 Truffle 项目一起提供，通常不进行编辑。</li>
<li>打开<code>migrations/1_initial_migration.js</code>文件。该文件是在文件中<code>Migrations</code>找到的合约的迁移（部署）脚本<code>Migrations.sol</code>。</li>
<li>打开<code>migrations/2_deploy_contracts.js</code>文件。该文件是<code>MetaCoin</code>合约的迁移脚本。（迁移脚本是按顺序运行的，所以以 . 开头的文件<code>2</code>会在以<code>1</code>. 开头的文件之后运行）</li>
<li>打开<code>test/TestMetaCoin.sol</code>文件。这是一个<a href="https://trufflesuite.com/docs/truffle/testing/writing-tests-in-solidity">用 Solidity 编写的测试文件</a>，可确保您的合约按预期工作。</li>
<li>打开<code>test/metacoin.js</code>文件。这是一个<a href="https://trufflesuite.com/docs/truffle/testing/writing-tests-in-javascript">用 JavaScript 编写的测试文件，</a>它执行与上面的 Solidity 测试类似的功能。</li>
<li>打开<code>truffle-config.js</code>文件。这是 Truffle<a href="https://trufflesuite.com/docs/truffle/reference/configuration">配置文件</a>，用于设置网络信息和其他与项目相关的设置。该文件是空白的，但这没关系，因为我们将使用具有一些内置默认值的 Truffle 命令。</li>
</ol>
<h2 id="测试">测试</h2>
<ol>
<li>在终端中，运行 Solidity 测试：</li>
</ol>
<pre tabindex="0"><code>truffle test ./test/TestMetaCoin.sol
</code></pre><p>您将看到以下输出：</p>
<pre tabindex="0"><code>  TestMetacoin
    √ testInitialBalanceUsingDeployedContract (71ms)
    √ testInitialBalanceWithNewMetaCoin (59ms)

  2 passing (794ms)
</code></pre><p><strong>注意</strong>：如果您在 Windows 上运行此命令时遇到问题，请参阅<a href="https://trufflesuite.com/docs/truffle/reference/configuration#resolving-naming-conflicts-on-windows">解决 Windows 上的命名冲突</a>的文档。</p>
<p>这两个测试是根据合同运行的，并显示了测试应该做什么的描述。</p>
<ol>
<li>运行 JavaScript 测试：</li>
</ol>
<pre tabindex="0"><code>truffle test ./test/metacoin.js
</code></pre><p>您将看到以下输出：</p>
<pre tabindex="0"><code>  Contract: MetaCoin
    √ should put 10000 MetaCoin in the first account
    √ should call a function that depends on a linked library (40ms)
    √ should send coin correctly (129ms)

  3 passing (255ms)
</code></pre><h2 id="编译">编译</h2>
<ol>
<li>编译智能合约：</li>
</ol>
<pre tabindex="0"><code>truffle compile
</code></pre><p>您将看到以下输出：</p>
<pre tabindex="0"><code>Compiling .\contracts\ConvertLib.sol...
Compiling .\contracts\MetaCoin.sol...
Compiling .\contracts\Migrations.sol...

Writing artifacts to .\build\contracts
</code></pre><h2 id="使用-truffle-develop-迁移">使用 Truffle Develop 迁移</h2>
<p><strong>注意</strong>：要使用<a href="https://trufflesuite.com/ganache">Ganache</a>，请跳到下一节。</p>
<p>要部署我们的智能合约，我们需要连接到区块链。Truffle 有一个内置的个人区块链，可用于测试。该区块链位于您的系统本地，不与以太坊主网络交互。</p>
<p>您可以使用<a href="https://trufflesuite.com/docs/truffle/getting-started/using-truffle-develop-and-the-console#truffle-develop">Truffle Develop</a>创建此区块链并与之交互。</p>
<ol>
<li>运行Truffle开发：</li>
</ol>
<pre tabindex="0"><code>truffle develop
</code></pre><p>您将看到以下信息：</p>
<pre tabindex="0"><code>Truffle Develop started at http://127.0.0.1:9545/

Accounts:
(0) 0x627306090abab3a6e1400e9345bc60c78a8bef57
(1) 0xf17f52151ebef6c7334fad080c5704d77216b732
(2) 0xc5fdf4076b8f3a5357c5e395ab970b5b54098fef
(3) 0x821aea9a577a9b44299b9c15c88cf3087f3b5544
(4) 0x0d1d4e623d10f9fba5db95830f7d3839406c6af2
(5) 0x2932b7a2355d6fecc4b5c0b6bd44cc31df247a2e
(6) 0x2191ef87e392377ec08e7c08eb105ef5448eced5
(7) 0x0f4f2ac550a1b4e2280d04c21cea7ebd822934b5
(8) 0x6330a553fc93768f612722bb8c2ec78ac90b3bbc
(9) 0x5aeda56215b167893e80b4fe645ba6d5bab767de

Private Keys:
(0) c87509a1c067bbde78beb793e6fa76530b6382a4c0241e5e4a9ec0a0f44dc0d3
(1) ae6ae8e5ccbfb04590405997ee2d52d2b330726137b875053c36d94e974d162f
(2) 0dbbe8e4ae425a6d2687f1a7e3ba17bc98c673636790f1b8ad91193c05875ef1
(3) c88b703fb08cbea894b6aeff5a544fb92e78a18e19814cd85da83b71f772aa6c
(4) 388c684f0ba1ef5017716adb5d21a053ea8e90277d0868337519f97bede61418
(5) 659cbb0e2411a44db63778987b1e22153c086a95eb6b18bdf89de078917abc63
(6) 82d052c865f5763aad42add438569276c00d3d88a2d062d36b2bae914d58b8c8
(7) aa3680d5d48a8283413f7a108367c7299ca73f553735860a87b08f39395618b7
(8) 0f62d96d6675f32685bbdb8ac13cda7c23436f63efbb9d07700d8669ff12b7c4
(9) 8d5366123cb560bb606379f90a0bfd4769eecc0557f1b362dcae9012b548b1e5

Mnemonic: candy maple cake sugar pudding cream honey rich smooth crumble sweet treat

⚠️  Important ⚠️  : This mnemonic was created for you by Truffle. It is not secure.
Ensure you do not use it on production blockchains, or else you risk losing funds.

truffle(development)&gt;
</code></pre><p>这显示了与区块链交互时可以使用的十个帐户（及其私钥）。</p>
<ol>
<li>在 Truffle Develop 提示符下，可以通过省略<code>truffle</code>前缀来运行 Truffle 命令。例如，要<code>truffle compile</code>在提示符下运行，请键入<code>compile</code>。将已编译的合约部署到区块链的命令是<code>truffle migrate</code>，因此在提示符处键入：</li>
</ol>
<pre tabindex="0"><code>migrate
</code></pre><p>您将看到以下输出：</p>
<pre tabindex="0"><code>Starting migrations...
======================
&gt; Network name:    'develop'
&gt; Network id:      4447
&gt; Block gas limit: 6721975

1_initial_migration.js
======================

   Deploying 'Migrations'
   ----------------------
   &gt; transaction hash:    0x3fd222279dad48583a3320decd0a2d12e82e728ba9a0f19bdaaff98c72a030a2
   &gt; Blocks: 0            Seconds: 0
   &gt; contract address:    0xa0AdaB6E829C818d50c75F17CFCc2e15bfd55a63
   &gt; account:             0x627306090abab3a6e1400e9345bc60c78a8bef57
   &gt; balance:             99.99445076
   &gt; gas used:            277462
   &gt; gas price:           20 gwei
   &gt; value sent:          0 ETH
   &gt; total cost:          0.00554924 ETH

   &gt; Saving migration to chain.
   &gt; Saving artifacts
   -------------------------------------
   &gt; Total cost:          0.00554924 ETH

2_deploy_contracts.js
=====================

   Deploying 'ConvertLib'
   ----------------------
   &gt; transaction hash:    0x97e8168f1c05fc40dd8ffc529b9a2bf45cc7c55b07b6b9a5a22173235ee247b6
   &gt; Blocks: 0            Seconds: 0
   &gt; contract address:    0xfb39FeaeF3ac3fd46e2123768e559BCe6bD638d6
   &gt; account:             0x627306090abab3a6e1400e9345bc60c78a8bef57
   &gt; balance:             99.9914458
   &gt; gas used:            108240
   &gt; gas price:           20 gwei
   &gt; value sent:          0 ETH
   &gt; total cost:          0.0021648 ETH

   Linking
   -------
   * Contract: MetaCoin &lt;--&gt; Library: ConvertLib (at address: 0xfb39FeaeF3ac3fd46e2123768e559BCe6bD638d6)

   Deploying 'MetaCoin'
   --------------------
   &gt; transaction hash:    0xee4994097c10e7314cc83adf899d67f51f22e08b920e95b6d3f75c5eb498bde4
   &gt; Blocks: 0            Seconds: 0
   &gt; contract address:    0x6891Ac4E2EF3dA9bc88C96fEDbC9eA4d6D88F768
   &gt; account:             0x627306090abab3a6e1400e9345bc60c78a8bef57
   &gt; balance:             99.98449716
   &gt; gas used:            347432
   &gt; gas price:           20 gwei
   &gt; value sent:          0 ETH
   &gt; total cost:          0.00694864 ETH

   &gt; Saving migration to chain.
   &gt; Saving artifacts
   -------------------------------------
   &gt; Total cost:          0.00911344 ETH

Summary
=======
&gt; Total deployments:   3
&gt; Final cost:          0.01466268 ETH
</code></pre><p>这显示了已部署合约的交易 ID 和地址。它还包括成本汇总和实时状态更新。</p>
<p><strong>注意</strong>：您的交易哈希、合约地址和账户将与上述不同。</p>
<p><strong>注意</strong>：要查看如何与合约交互，请跳到下一节。</p>
<h2 id="替代方案使用-ganache-迁移">替代方案：使用 Ganache 迁移</h2>
<p>虽然 Truffle Develop 是一个一体化的个人区块链和控制台，但您也可以使用桌面应用程序<a href="https://trufflesuite.com/ganache">Ganache</a>来启动您的个人区块链。对于那些刚接触以太坊和区块链的人来说，Ganache 可能是一个更易于理解的工具，因为它预先显示了更多信息。</p>
<p>除了运行 Ganache 之外，唯一的额外步骤是它需要编辑 Truffle 配置文件以指向 Ganache 实例。</p>
<ol>
<li>下载并安装<a href="https://trufflesuite.com/ganache">Ganache</a>。</li>
<li><code>truffle-config.js</code>在文本编辑器中打开。将内容替换为以下内容：</li>
</ol>
<pre tabindex="0"><code>module.exports = {
  networks: {
    development: {
      host: &quot;127.0.0.1&quot;,
      port: 7545,
      network_id: &quot;*&quot;
    }
  }
};
</code></pre><p>这将允许使用 Ganache 的默认连接参数进行连接。</p>
<ol>
<li>保存并关闭该文件。</li>
<li>启动甘纳许。</li>
</ol>
<p>
        <img class="mx-auto" alt="伽纳彻" src="https://cdn.jsdelivr.net/gh/zshipu/images/202206112128229.png" />   
    </p>
<p><em>伽纳彻</em></p>
<ol>
<li>在终端上，将合约迁移到 Ganache 创建的区块链：</li>
</ol>
<pre tabindex="0"><code>truffle migrate
</code></pre><p>您将看到以下输出：</p>
<pre tabindex="0"><code>Compiling your contracts...
===========================
&gt; Compiling ./contracts/ConvertLib.sol
&gt; Compiling ./contracts/MetaCoin.sol
&gt; Compiling ./contracts/Migrations.sol
&gt; Artifacts written to /home/david/work/MetaCoin/build/contracts
&gt; Compiled successfully using:
   - solc: 0.5.16+commit.9c3226ce.Emscripten.clang

Starting migrations...
======================
&gt; Network name:    'development'
&gt; Network id:      5777
&gt; Block gas limit: 6721975 (0x6691b7)

1_initial_migration.js
======================

   Deploying 'Migrations'
   ----------------------
   &gt; transaction hash:    0x3eef05e35ce694c0b7112cc22ba462b9cc0563abc2cc444ee9683b6d89865e3c
   &gt; Blocks: 0            Seconds: 0
   &gt; contract address:    0x8CdaF0CD259887258Bc13a92C0a6dA92698644C0
   &gt; block number:        1
   &gt; block timestamp:     1587421933
   &gt; account:             0x627306090abaB3A6e1400e9345bC60c78a8BEf57
   &gt; balance:             99.9967165
   &gt; gas used:            164175 (0x2814f)
   &gt; gas price:           20 gwei
   &gt; value sent:          0 ETH
   &gt; total cost:          0.0032835 ETH

   &gt; Saving migration to chain.
   &gt; Saving artifacts
   -------------------------------------
   &gt; Total cost:           0.0032835 ETH

2_deploy_contracts.js
=====================

   Deploying 'ConvertLib'
   ----------------------
   &gt; transaction hash:    0x23de020bafa41e30615b1d775d2fa9604e876415408e012d1f0faf79eed3a32f
   &gt; Blocks: 0            Seconds: 0
   &gt; contract address:    0x345cA3e014Aaf5dcA488057592ee47305D9B3e10
   &gt; block number:        3
   &gt; block timestamp:     1587421933
   &gt; account:             0x627306090abaB3A6e1400e9345bC60c78a8BEf57
   &gt; balance:             99.99396028
   &gt; gas used:            95470 (0x174ee)
   &gt; gas price:           20 gwei
   &gt; value sent:          0 ETH
   &gt; total cost:          0.0019094 ETH

   Linking
   -------
   * Contract: MetaCoin &lt;--&gt; Library: ConvertLib (at address: 0x345cA3e014Aaf5dcA488057592ee47305D9B3e10)

   Deploying 'MetaCoin'
   --------------------
   &gt; transaction hash:    0x0cc20353422c4d435f72e8e7850f8178f43bf8d00c8c0d09cc8e0ccdfa81b799
   &gt; Blocks: 0            Seconds: 0
   &gt; contract address:    0xf25186B5081Ff5cE73482AD761DB0eB0d25abfBF
   &gt; block number:        4
   &gt; block timestamp:     1587421934
   &gt; account:             0x627306090abaB3A6e1400e9345bC60c78a8BEf57
   &gt; balance:             99.98822922
   &gt; gas used:            286553 (0x45f59)
   &gt; gas price:           20 gwei
   &gt; value sent:          0 ETH
   &gt; total cost:          0.00573106 ETH

   &gt; Saving migration to chain.
   &gt; Saving artifacts
   -------------------------------------
   &gt; Total cost:          0.00764046 ETH

Summary
=======
&gt; Total deployments:   3
&gt; Final cost:          0.01092396 ETH
</code></pre><p>这显示了已部署合约的交易 ID 和地址。它还包括成本汇总和实时状态更新。</p>
<p><strong>注意</strong>：您的交易 ID 和合约地址可能与上述不同。</p>
<ol>
<li>在 Ganache 中，单击“事务”按钮以查看事务已被处理。</li>
<li>要与合约交互，您可以使用 Truffle 控制台。Truffle 控制台类似于 Truffle Develop，除了它连接到现有的区块链（在本例中，是由 Ganache 生成的区块链）。</li>
</ol>
<pre tabindex="0"><code>truffle console
</code></pre><p>您将看到以下提示：</p>
<pre tabindex="0"><code>truffle(development)&gt;
</code></pre><h2 id="与合约互动">与合约互动</h2>
<p>通过以下方式使用控制台与合约交互：</p>
<p><strong>注意</strong>：我们<code>web3.eth.getAccounts()</code>在这些示例中使用，它返回一个 Promise，它解析为由助记符生成的所有帐户的数组。所以，给定上面我们的助记符生成的地址，指定<code>(await web3.eth.getAccounts())[0]</code>就等同于地址<code>0x627306090abab3a6e1400e9345bc60c78a8bef57</code>。</p>
<p>从 Truffle v5 开始，控制台支持 async/await 功能，从而可以与合约进行更简单的交互。</p>
<ul>
<li>首先建立部署的 MetaCoin 合约实例和由 Truffle 的内置区块链或 Ganache 创建的帐户：</li>
</ul>
<pre tabindex="0"><code>truffle(development)&gt; let instance = await MetaCoin.deployed()
truffle(development)&gt; let accounts = await web3.eth.getAccounts()
</code></pre><ul>
<li>检查部署合约账户的元币余额：</li>
</ul>
<pre tabindex="0"><code>truffle(development)&gt; let balance = await instance.getBalance(accounts[0])
truffle(development)&gt; balance.toNumber()
</code></pre><ul>
<li>查看该余额值多少以太币（并注意合约将元币定义为价值 2 以太币）：</li>
</ul>
<pre tabindex="0"><code>truffle(development)&gt; let ether = await instance.getBalanceInEth(accounts[0])
truffle(development)&gt; ether.toNumber()
</code></pre><ul>
<li>将一些元币从一个账户转移到另一个账户：</li>
</ul>
<pre tabindex="0"><code>truffle(development)&gt; instance.sendCoin(accounts[1], 500)
</code></pre><ul>
<li>查看<em>收到</em>元币的账户余额：</li>
</ul>
<pre tabindex="0"><code>truffle(development)&gt; let received = await instance.getBalance(accounts[1])
truffle(development)&gt; received.toNumber()
</code></pre><ul>
<li>检查<em>发送</em>元币的账户余额：</li>
</ul>
<pre tabindex="0"><code>truffle(development)&gt; let newBalance = await instance.getBalance(accounts[0])
truffle(development)&gt; newBalance.toNumber()
</code></pre>
        </div>

        
<div class="post-archive">
    <ul class="post-copyright">
        <li><strong>原文作者：</strong><a rel="author" href="https://geek.zshipu.com/">知识铺</a></li>
        <li style="word-break:break-all"><strong>原文链接：</strong><a href="https://geek.zshipu.com/post/web3.0/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%8E%E9%9B%B6%E5%88%B0%E7%95%A5%E6%87%825Truffle-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E4%BD%93%E9%AA%8C%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6/">https://geek.zshipu.com/post/web3.0/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%8E%E9%9B%B6%E5%88%B0%E7%95%A5%E6%87%825Truffle-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E4%BD%93%E9%AA%8C%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6/</a></li>
        <li><strong>版权声明：</strong>本作品采用<a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a>进行许可，非商业转载请注明出处（作者，原文链接），商业转载请联系作者获得授权。</li>
        <li><strong>免责声明：</strong>本页面内容均来源于站内编辑发布，部分信息来源互联网，并不意味着本站赞同其观点或者证实其内容的真实性，如涉及版权等问题，请立即联系客服进行更改或删除，保证您的合法权益。转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。也可以邮件至 sblig@126.com</li>
    </ul>
</div>
<br/>



        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/post/web3.0/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%8E%E9%9B%B6%E5%88%B0%E7%95%A5%E6%87%8242021-%E5%B9%B4-Web3.0-%E5%92%8C-Solidity-%E5%BC%80%E5%8F%91%E8%B7%AF%E7%BA%BF%E5%9B%BE/">以太坊从零到略懂4： Web3.0 和 Solidity 开发路线图</a></li>
        
        <li><a href="/post/web3.0/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%8E%E9%9B%B6%E5%88%B0%E7%95%A5%E6%87%823%E5%BC%80%E5%8F%91%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%90%88%E7%BA%A6/">web3.0 以太坊从零到略懂3：开发第一个合约</a></li>
        
        <li><a href="/post/web3.0/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%8E%E9%9B%B6%E5%88%B0%E7%95%A5%E6%87%822%E8%AE%BE%E7%BD%AE%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/">web3.0 以太坊从零到略懂2：设置开发环境</a></li>
        
        <li><a href="/post/web3.0/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%8E%E9%9B%B6%E5%88%B0%E7%95%A5%E6%87%821%E7%AE%80%E4%BB%8B/">web3.0 以太坊从零到略懂1：简介</a></li>
        
        <li><a href="/post/web/Web-3.0%E5%BC%80%E5%8F%91%E8%80%85%E8%B7%AF%E7%BA%BF%E5%9B%BE%E6%8C%87%E5%8D%97%E5%92%8C%E5%85%A5%E9%97%A8%E8%B5%84%E6%BA%90/">Web 3.0：开发者路线图、指南和入门资源</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='/tags/web3'>web3</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "zshipu/zshipu-geek"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2022 <a href="https://geek.zshipu.com/">知识铺的博客 By 知识铺</a>
        
        | <a rel="nofollow" target="_blank" href="https://beian.miit.gov.cn/">浙 ICP 备19032823号-1</a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://geek.zshipu.com/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://geek.zshipu.com/">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://geek.zshipu.com/post/web3.0/%E5%85%A8%E6%A0%88-Web3-%E5%BC%80%E5%8F%91%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/" title="web3.0 全栈 Web3 开发完整指南">web3.0 全栈 Web3 开发完整指南</a>
    </li>
    
    <li>
        <a href="https://geek.zshipu.com/post/web3.0/%E5%85%A8%E6%A0%88%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%BC%80%E5%8F%91%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/" title="web3.0 全栈以太坊开发完整指南">web3.0 全栈以太坊开发完整指南</a>
    </li>
    
    <li>
        <a href="https://geek.zshipu.com/post/web3.0/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%8E%E9%9B%B6%E5%88%B0%E7%95%A5%E6%87%825Truffle-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E4%BD%93%E9%AA%8C%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6/" title="以太坊从零到略懂5：Truffle 快速入门体验智能合约">以太坊从零到略懂5：Truffle 快速入门体验智能合约</a>
    </li>
    
    <li>
        <a href="https://geek.zshipu.com/post/web3.0/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%8E%E9%9B%B6%E5%88%B0%E7%95%A5%E6%87%8242021-%E5%B9%B4-Web3.0-%E5%92%8C-Solidity-%E5%BC%80%E5%8F%91%E8%B7%AF%E7%BA%BF%E5%9B%BE/" title="以太坊从零到略懂4： Web3.0 和 Solidity 开发路线图">以太坊从零到略懂4： Web3.0 和 Solidity 开发路线图</a>
    </li>
    
    <li>
        <a href="https://geek.zshipu.com/post/web3.0/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%8E%E9%9B%B6%E5%88%B0%E7%95%A5%E6%87%823%E5%BC%80%E5%8F%91%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%90%88%E7%BA%A6/" title="web3.0 以太坊从零到略懂3：开发第一个合约">web3.0 以太坊从零到略懂3：开发第一个合约</a>
    </li>
    
    <li>
        <a href="https://geek.zshipu.com/post/web3.0/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%8E%E9%9B%B6%E5%88%B0%E7%95%A5%E6%87%822%E8%AE%BE%E7%BD%AE%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/" title="web3.0 以太坊从零到略懂2：设置开发环境">web3.0 以太坊从零到略懂2：设置开发环境</a>
    </li>
    
    <li>
        <a href="https://geek.zshipu.com/post/web3.0/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%8E%E9%9B%B6%E5%88%B0%E7%95%A5%E6%87%821%E7%AE%80%E4%BB%8B/" title="web3.0 以太坊从零到略懂1：简介">web3.0 以太坊从零到略懂1：简介</a>
    </li>
    
    <li>
        <a href="https://geek.zshipu.com/post/nexp/css-level-01/css-level-007-CSS%E4%B8%8D%E9%80%8F%E6%98%8E%E5%BA%A6-%E9%80%8F%E6%98%8E%E5%BA%A6/" title="css-level-007 CSS不透明度-透明度">css-level-007 CSS不透明度-透明度</a>
    </li>
    
    <li>
        <a href="https://geek.zshipu.com/post/nexp/css-level-01/css-level-006-CSS-%E4%B8%ADpxemremvwvh%E5%8D%95%E4%BD%8D%E4%B9%8B%E9%97%B4%E7%9A%84%E5%8C%BA%E5%88%AB%E8%AF%A6%E8%A7%A3/" title="css-level-006 CSS 中px、em、rem、%、vw、vh单位之间的区别详解">css-level-006 CSS 中px、em、rem、%、vw、vh单位之间的区别详解</a>
    </li>
    
    <li>
        <a href="https://geek.zshipu.com/post/nexp/css-level-01/css-level-005-CSS%E9%80%89%E6%8B%A9%E5%99%A8/" title="css-level-005 CSS选择器">css-level-005 CSS选择器</a>
    </li>
    
</ul>
    </section>

    
<section class="widget">
    <h3 class="widget-title" style="color:red">福利派送</h3>
    <ul class="widget-list">
        
        <li>
            <a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?source=5176.11533457&amp;userCode=tzm8r4hc" title="【2019双12】ALL IN CLoud 低至1折" target="_blank" style="color:red">
                
                    <img src="https://img.alicdn.com/tfs/TB1_rYHo7P2gK0jSZPxXXacQpXa-690-388.jpg">
                
            </a>
        </li>
        
        <li>
            <a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?source=5176.11533457&amp;userCode=tzm8r4hc" title="助力产业智慧升级，云服务器首年88元起，更有千元代金券礼包免费领！" target="_blank" style="color:red">
                
                    <img src="https://upload-dianshi-1255598498.file.myqcloud.com/345-7c71532bd4935fbdd9a67c1a71e577b1767b805c.200%E7%89%88%E6%9C%ACB.jpg">
                
            </a>
        </li>
        
        <li>
            <a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?source=5176.11533457&amp;userCode=tzm8r4hc" title="【渠道专享低折扣】11月特惠 限时2折" target="_blank" style="color:red">
                
                    <img src="https://img.alicdn.com/tfs/TB1hblJl7Y2gK0jSZFgXXc5OFXa-750-400.jpg">
                
            </a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title"><a href='/categories/'>分类</a></h3>
<ul class="widget-list">
    
    <li><a href="https://geek.zshipu.com/categories/flutter/">flutter (30)</a></li>
    
    <li><a href="https://geek.zshipu.com/categories/iOS/">iOS (7)</a></li>
    
    <li><a href="https://geek.zshipu.com/categories/unix/">unix (9)</a></li>
    
    <li><a href="https://geek.zshipu.com/categories/%E7%AE%97%E6%B3%95/">算法 (3)</a></li>
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href='/tags/'>标签</a></h3>
<div class="tagcloud">
    
    <a href="https://geek.zshipu.com/tags/BI/">BI</a>
    
    <a href="https://geek.zshipu.com/tags/DDD/">DDD</a>
    
    <a href="https://geek.zshipu.com/tags/DDD%E5%AE%9E%E6%88%98/">DDD实战</a>
    
    <a href="https://geek.zshipu.com/tags/DevOps/">DevOps</a>
    
    <a href="https://geek.zshipu.com/tags/IM/">IM</a>
    
    <a href="https://geek.zshipu.com/tags/js/">js</a>
    
    <a href="https://geek.zshipu.com/tags/java/">java</a>
    
    <a href="https://geek.zshipu.com/tags/JavaScript/">JavaScript</a>
    
    <a href="https://geek.zshipu.com/tags/Monorepo/">Monorepo</a>
    
    <a href="https://geek.zshipu.com/tags/Netty/">Netty</a>
    
    <a href="https://geek.zshipu.com/tags/nextjs/">nextjs</a>
    
    <a href="https://geek.zshipu.com/tags/nextjs/">nextjs</a>
    
    <a href="https://geek.zshipu.com/tags/Typora/">Typora</a>
    
    <a href="https://geek.zshipu.com/tags/WebRTC/">WebRTC</a>
    
    <a href="https://geek.zshipu.com/tags/android/">android</a>
    
    <a href="https://geek.zshipu.com/tags/apollo/">apollo</a>
    
    <a href="https://geek.zshipu.com/tags/css/">css</a>
    
    <a href="https://geek.zshipu.com/tags/flutter/">flutter</a>
    
    <a href="https://geek.zshipu.com/tags/game/">game</a>
    
    <a href="https://geek.zshipu.com/tags/github/">github</a>
    
    <a href="https://geek.zshipu.com/tags/go/">go</a>
    
    <a href="https://geek.zshipu.com/tags/golang/">golang</a>
    
    <a href="https://geek.zshipu.com/tags/graphql/">graphql</a>
    
    <a href="https://geek.zshipu.com/tags/java/">java</a>
    
    <a href="https://geek.zshipu.com/tags/js/">js</a>
    
    <a href="https://geek.zshipu.com/tags/mysql/">mysql</a>
    
    <a href="https://geek.zshipu.com/tags/nexp/">nexp</a>
    
    <a href="https://geek.zshipu.com/tags/nextjs/">nextjs</a>
    
    <a href="https://geek.zshipu.com/tags/nifi/">nifi</a>
    
    <a href="https://geek.zshipu.com/tags/nodejs/">nodejs</a>
    
    <a href="https://geek.zshipu.com/tags/npm/">npm</a>
    
    <a href="https://geek.zshipu.com/tags/python/">python</a>
    
    <a href="https://geek.zshipu.com/tags/react/">react</a>
    
    <a href="https://geek.zshipu.com/tags/reactjs/">reactjs</a>
    
    <a href="https://geek.zshipu.com/tags/sqllit/">sqllit</a>
    
    <a href="https://geek.zshipu.com/tags/storybook/">storybook</a>
    
    <a href="https://geek.zshipu.com/tags/tailwind/">tailwind</a>
    
    <a href="https://geek.zshipu.com/tags/vuejs/">vuejs</a>
    
    <a href="https://geek.zshipu.com/tags/web/">web</a>
    
    <a href="https://geek.zshipu.com/tags/web3/">web3</a>
    
    <a href="https://geek.zshipu.com/tags/%E4%B9%A6%E7%B1%8D/">书籍</a>
    
    <a href="https://geek.zshipu.com/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/">人工智能</a>
    
    <a href="https://geek.zshipu.com/tags/%E5%88%86%E8%AF%8D/">分词</a>
    
    <a href="https://geek.zshipu.com/tags/%E5%AD%A6%E4%B9%A0/">学习</a>
    
    <a href="https://geek.zshipu.com/tags/%E6%96%87%E6%91%98/">文摘</a>
    
    <a href="https://geek.zshipu.com/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a>
    
    <a href="https://geek.zshipu.com/tags/%E6%9E%B6%E6%9E%84/">架构</a>
    
    <a href="https://geek.zshipu.com/tags/%E7%88%AC%E8%99%AB/">爬虫</a>
    
    <a href="https://geek.zshipu.com/tags/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F/">用户画像</a>
    
    <a href="https://geek.zshipu.com/tags/%E7%BA%BF%E7%A8%8B/">线程</a>
    
    <a href="https://geek.zshipu.com/tags/%E8%B5%B7%E6%AD%A5/">起步</a>
    
</div>
    </section>

    
<section class="widget">
    <h3 class="widget-title">友情链接</h3>
    <ul class="widget-list">
        
        <li>
            <a target="_blank" href="https://blog.zshipu.com//" title="知识铺的博客">知识铺的博客</a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://geek.zshipu.com/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>